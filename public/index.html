<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>CardsLawp | Gift Cards Store</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <!-- Navbar -->
  <nav class="navbar">
    <div class="logo">CardsLawp</div>
    <div class="nav-links">
      <a href="#" id="homeTab" class="active">Home</a>
      <a href="#" id="requestTab">Suggest</a>
      <button id="cartBtn">Cart ðŸ›’ (<span id="cartCount">0</span>)</button>
    </div>
  </nav>

  <!-- Hero Section -->
  <header class="hero">
    <h1>Buy Gift Cards Instantly</h1>
    <p>Fast, secure, and easy digital gift card store.</p>
    <button class="hero-btn">Shop Now</button>
  </header>

  <!-- Cards Section -->
  <section class="cards-container" id="productSection">
    <!-- Admin-added gift cards will load here -->
  </section>

  <!-- Suggest Gift Card Section -->
  <section class="suggest fade" id="suggestSection" style="display:none;">
    <h2>Suggest a New Gift Card</h2>
    <input id="reqName" placeholder="Gift Card Name">
    <input id="reqImg" placeholder="Image URL">
    <textarea id="reqDesc" placeholder="Description"></textarea>
    <button id="reqSubmit">Submit Request</button>
  </section>

  <!-- Item Preview Modal -->
  <div class="modal" id="itemModal">
    <div class="modal-content">
      <span class="close" onclick="closeModal()">&times;</span>
      <img id="modalImg" src="">
      <h2 id="modalTitle"></h2>
      <p id="modalDesc"></p>
      <div class="modal-actions">
        <button class="addCartBtn">Add to Cart</button>
      </div>
    </div>
  </div>

  <!-- Cart Sidebar -->
  <div id="cartSidebar">
    <h2>Your Cart</h2>
    <div id="cartItems"></div>
    <h3>Total: $<span id="cartTotal">0</span></h3>
    <button id="checkoutBtn">Checkout</button>
  </div>

  <script>
    // Scroll fade animation
    const fades = document.querySelectorAll('.fade');
    window.addEventListener('scroll', () => {
      fades.forEach(el => {
        const rect = el.getBoundingClientRect();
        el.style.opacity = rect.top < window.innerHeight - 100 ? 1 : 0;
        el.style.transform = rect.top < window.innerHeight - 100 ? 'translateY(0)' : 'translateY(30px)';
      });
    });

    // Tabs
    const homeTab = document.getElementById('homeTab');
    const requestTab = document.getElementById('requestTab');
    const productSection = document.getElementById('productSection');
    const suggestSection = document.getElementById('suggestSection');

    homeTab.onclick = () => {
      productSection.style.display = 'flex';
      suggestSection.style.display = 'none';
      homeTab.classList.add('active');
      requestTab.classList.remove('active');
    };
    requestTab.onclick = () => {
      productSection.style.display = 'none';
      suggestSection.style.display = 'block';
      homeTab.classList.remove('active');
      requestTab.classList.add('active');
    };

    // Cart
    const cartBtn = document.getElementById('cartBtn');
    const cartSidebar = document.getElementById('cartSidebar');
    const cartItemsDiv = document.getElementById('cartItems');
    const cartTotalEl = document.getElementById('cartTotal');
    const cartCount = document.getElementById('cartCount');
    let cart = [];

    cartBtn.onclick = () => {
      cartSidebar.style.right = cartSidebar.style.right === '0px' ? '-350px' : '0px';
    };

    function updateCart() {
      cartItemsDiv.innerHTML = '';
      let total = 0;
      cart.forEach((item, index) => {
        total += item.price;
        const div = document.createElement('div');
        div.className = 'cart-item';
        div.innerHTML = `
          <img src="${item.image}">
          <span>${item.name} - $${item.price}</span>
          <button onclick="removeFromCart(${index})">X</button>
        `;
        cartItemsDiv.appendChild(div);
      });
      cartTotalEl.innerText = total.toFixed(2);
      cartCount.innerText = cart.length;
    }

    function addToCart(item) {
      cart.push(item);
      updateCart();
      cartSidebar.style.right = '0px';
    }

    function removeFromCart(index) {
      cart.splice(index, 1);
      updateCart();
    }

    document.getElementById('checkoutBtn').onclick = () => {
      if(cart.length === 0) { alert('Cart is empty'); return; }
      alert('Proceed to checkout with PayPal/Stripe integration');
    };

    // Item preview modal
    const modal = document.getElementById('itemModal');
    const modalTitle = document.getElementById('modalTitle');
    const modalImg = document.getElementById('modalImg');
    const modalDesc = document.getElementById('modalDesc');
    const addCartBtn = document.querySelector('.addCartBtn');
    let currentItem = null;

    function showItem(name,img,desc,price){
      modal.style.display = 'flex';
      modalTitle.innerText = name;
      modalImg.src = img;
      modalDesc.innerText = desc;
      currentItem = {name,img,desc,price};
    }

    addCartBtn.onclick = () => {
      if(currentItem) addToCart(currentItem);
      closeModal();
    };

    function closeModal(){
      modal.style.display = 'none';
    }

    window.onclick = function(e){
      if(e.target===modal) closeModal();
    };

    // Suggest Gift Card
    document.getElementById('reqSubmit').onclick = () => {
      alert('Gift card request submitted for admin approval!');
      document.getElementById('reqName').value = '';
      document.getElementById('reqImg').value = '';
      document.getElementById('reqDesc').value = '';
      // Here, you would send a request to the backend for admin review
    };

    // Load admin cards (fetch from backend API)
    async function loadCardsFromAdmin() {
      try {
        const response = await fetch('/api/cards'); // backend endpoint returns approved cards
        const cards = await response.json();
        productSection.innerHTML = cards.map(c => `
          <div class="card fade">
            <img src="${c.image}">
            <h2>${c.name}</h2>
            <p>${c.description}</p>
            <button onclick="showItem('${c.name}','${c.image}','${c.description}',${c.price})">View</button>
          </div>
        `).join('');
      } catch(err) {
        productSection.innerHTML = '<p>No gift cards available right now.</p>';
      }
    }

    loadCardsFromAdmin();
  </script>
</body>
</html>